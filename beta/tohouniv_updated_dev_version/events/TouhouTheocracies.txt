########################################
# Events for Touhou Theocracies
########################################

namespace = touhou_theocracy

country_event = {
	id = touhou_theocracy.1
	title = touhou_theocracy.1.t
	desc = touhou_theocracy.1.desc
	picture = {
		trigger = { 
			OR = {
				religion_group = eastern 
				religion_group = Touhou 
			}
		}
		picture = SHRINE_eventPicture
	}
	picture = {
		trigger = { 
			NOT = { religion_group = eastern }
			NOT = { religion_group = Touhou }
		}
		picture = RELIGION_eventPicture
	}

	is_triggered_only = yes

	trigger = {
		has_reform = Gensokyan_shrine_theocracy
		NOT = { has_country_flag = in_theocracy_heir_selection }
		NOT = { has_country_flag = is_selecting_stat_bonus_for_heir }
		has_government_attribute = heir
		has_heir = no
	}

	immediate = {
		hidden_effect = {
			set_country_flag = in_theocracy_heir_selection

			if = {
				limit = {
					has_country_flag = KOL_secondogeniture_of_BAV
					OR = {
						is_subject = no
						overlord = {
							OR = {
								NOT = { government = monarchy }
								NOT = { has_government_attribute = heir }
								AND = {
									NOT = { tag = BAV }
									NOT = { was_tag = BAV }
								}
							}
						}
					}
				}
				clr_country_flag = KOL_secondogeniture_of_BAV
			}
			else_if = {
				limit = {
					has_country_flag = KOL_secondogeniture_of_BAV
				}
				overlord = { save_event_target_as = probably_bavaria }
			}
			
			clr_country_flag = theo_local_noble_flag
			clr_country_flag = theo_foreign_noble_flag
			clr_country_flag = theo_merchants_son_flag
			clr_country_flag = theo_talented_theologian_flag
			clr_country_flag = theo_local_preacher_flag
			clr_country_flag = theo_papal_protege_flag
			clr_country_flag = theo_imam_khatib_flag
			clr_country_flag = theo_influential_reformer_flag
			
			#Local Noble,etc:
			if = {
				limit = {
					has_estate = estate_nobles
					any_owned_province = {
						is_capital = no
						is_state = yes
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
					}
					save_event_target_as = noble_province
				}
			}
			else_if = {
				limit = {
					OR = {
						has_estate = estate_maratha
						has_estate = estate_rajput
					}
					any_owned_province = {
						is_capital = no
						is_state = yes
						religion = hinduism
					}
					religion = hinduism
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
						religion = hinduism
					}
					save_event_target_as = noble_province
				}
			}
			if = {
				limit = {
					has_estate = estate_burghers
					any_owned_province = {
						is_capital = no
						is_state = yes
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
					}
					save_event_target_as = burgher_province
				}
			}
			else_if = {
				limit = {
					has_estate = estate_vaisyas
					religion = hinduism
					any_owned_province = {
						is_capital = no
						is_state = yes
						religion = hinduism
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
						religion = hinduism
					}
					save_event_target_as = burgher_province
				}
			}
			if = {
				limit = {
					has_estate = estate_church
					any_owned_province = {
						is_capital = no
						is_state = yes
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
					}
					save_event_target_as = church_province
				}
			}
			else_if = {
				limit = {
					has_estate = estate_brahmins
					religion = hinduism
					any_owned_province = {
						is_capital = no
						is_state = yes
						religion = hinduism
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						is_state = yes
						religion = hinduism
					}
					save_event_target_as = church_province
				}
			}
			#Papal Protoge:
			random_country = {
				limit = {
					OR = {
						tag = PAP
						culture_group = latin
					}
				}
				save_event_target_as = papal_protoge_country
			}
			
		}
	}

	option = {
		name = theocracy.1.a		# A Local Noble
		trigger = { NOT = { has_country_flag = KOL_secondogeniture_of_BAV } }
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_maratha
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_maratha
				loyalty = 15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_rajput
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_rajput
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_brahmins
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_brahmins
				loyalty = -15
			}
		}
		set_country_flag = theo_local_noble_flag # USED IN DEVOTION.TXT
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_saved_event_target = noble_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:noble_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = noble_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					culture = event_target:noble_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = noble_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_saved_event_target = noble_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					culture = event_target:noble_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = noble_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					female = yes
					culture = event_target:noble_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = noble_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_devotion = -5
		add_prestige = 10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.b		# A Foreign Noble
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
			any_neighbor_country = {
				government = monarchy
				has_regency = no
				religion = ROOT
			}
		}
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 10
			}
		}
		else_if = {
			limit = {
				has_estate = estate_maratha
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_maratha
				loyalty = 10
			}
		}
		else_if = {
			limit = {
				has_estate = estate_rajput
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_rajput
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -10
			}
		}
		else_if = {
			limit = {
				has_estate = estate_brahmins
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_brahmins
				loyalty = -10
			}
		}		
		set_country_flag = theo_foreign_noble_flag # USED IN DEVOTION.TXT
		random_neighbor_country = { 
			limit = {
				government = monarchy
				has_regency = no
				religion = ROOT
			}
			ROOT = {
				if = {
					limit = { has_government_attribute = can_see_theocratic_heir_stats }
					if = {
						limit = {
							NOT = {
								has_global_modifier_value = {
									which = female_advisor_chance
									value = 1
								}
							}
						}
						define_heir = { 
							dynasty = PREV 
							age = 35
							culture = PREV
						} 
					}
					else = {
						define_heir = { 
							dynasty = PREV 
							age = 35
							culture = PREV
							female = yes
						} 
					}
				}
				else = {
					if = {
						limit = {
							NOT = {
								has_global_modifier_value = {
									which = female_advisor_chance
									value = 1
								}
							}
						}
						define_heir = { 
							dynasty = PREV 
							age = 35
							culture = PREV
							hidden = yes
						} 
					}
					else = {
						define_heir = { 
							dynasty = PREV 
							age = 35
							culture = PREV
							female = yes
							hidden = yes
						} 
					}
				}
			}
			add_opinion = { who = ROOT modifier = opinion_theocracy_noble }
		}
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.c		# A Merchant's Son
		trigger = { NOT = { has_country_flag = KOL_secondogeniture_of_BAV } }
		if = {
			limit = {
				has_estate = estate_burghers
			}
			add_estate_loyalty = {
				estate = estate_burghers
				loyalty = 15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_vaisyas
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_vaisyas
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_brahmins
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_brahmins
				loyalty = -15
			}
		}
		set_country_flag = theo_merchants_son_flag # USED IN DEVOTION.TXT
		
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_saved_event_target = burgher_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:burgher_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = burgher_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					culture = event_target:burgher_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_saved_event_target = burgher_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					culture = event_target:burgher_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = burgher_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					female = yes
					culture = event_target:burgher_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_years_of_income = 0.35
		add_devotion = -5
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.e		# A Talented Theologian
		trigger = { NOT = { has_country_flag = KOL_secondogeniture_of_BAV } }
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_brahmins
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_brahmins
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_burghers
			}
			add_estate_loyalty = {
				estate = estate_burghers
				loyalty = -15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_vaisyas
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_vaisyas
				loyalty = -15
			}
		}
		set_country_flag = theo_talented_theologian_flag # USED IN DEVOTION.TXT
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_saved_event_target = church_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = church_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_saved_event_target = church_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = church_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					female = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_devotion = 5
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.f		# A Local Preacher
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
			NOT = {
				religion_group = muslim
			}
		}
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_brahmins
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_brahmins
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = -15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_maratha
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_maratha
				loyalty = -15
			}
		}
		else_if = {
			limit = {
				has_estate = estate_rajput
				religion = hinduism
			}
			add_estate_loyalty = {
				estate = estate_rajput
				loyalty = -15
			}
		}
		set_country_flag = theo_local_preacher_flag # USED IN DEVOTION.TXT
		
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_saved_event_target = church_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = church_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_saved_event_target = church_province
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = church_province
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					hidden = yes
					female = yes
					culture = event_target:church_province
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_devotion = 10
		add_prestige = -5
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.d		# A Papal Protege
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
			religion = catholic
		}
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = -10
			}
		}
		if = {
			limit = {
				has_estate = estate_burghers
			}
			add_estate_loyalty = {
				estate = estate_burghers
				loyalty = -10
			}
		}
		set_country_flag = theo_papal_protege_flag # USED IN DEVOTION.TXT
		
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_saved_event_target = papal_protoge_country
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:papal_protoge_country
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = papal_protoge_country
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					culture = event_target:papal_protoge_country
					female = yes
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_saved_event_target = papal_protoge_country
					NOT = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
				}
				define_heir = {
					age = 35
					culture = event_target:papal_protoge_country
					hidden = yes
				}
			}
			else_if = {
				limit = {
					has_saved_event_target = papal_protoge_country
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					culture = event_target:papal_protoge_country
					female = yes
					hidden = yes
				}
			}
			else_if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_papal_influence = 10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.g		# A Local Imam Khatib
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
			religion_group = muslim
		}
		set_country_flag = theo_imam_khatib_flag # USED IN DEVOTION.TXT
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 15
			}
		}
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = -15
			}
		}		
		
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		add_devotion = 10
		add_prestige = -10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.h		# An Influential Reformer
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
			OR = {
				religion = reformed
				religion = protestant
			}
		}
		set_country_flag = theo_influential_reformer_flag # USED IN DEVOTION.TXT
		if = {
			limit = {
				has_estate = estate_burghers
			}
			add_estate_loyalty = {
				estate = estate_burghers
				loyalty = 10
			}
		}		
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -10
			}
		}

		
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
				}
			}
			else = {
				define_heir = {
					age = 35
				}
			}
		}
		else = {
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
				}
			}
		}
		if = { 
			limit = { religion = reformed }
			add_fervor = 10
		}
		if = { 
			limit = { religion = protestant }
			add_church_power = 10
		}
		add_prestige = -10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}

	option = {
		name = touhou_theocracy.1.i		# True Heir of Hakurei
		trigger = {
			OR = {
				tag = HKR
				tag = GNK
			}
		}

		set_country_flag = theo_local_noble_flag # USED IN DEVOTION.TXT
		if = {
			limit = {
				has_saved_event_target = noble_province
			}
			define_heir = {
				age = 10
				dynasty = Hakurei
				hidden = yes
				adm = 1
				dip = 1
				mil = 2
				female = yes
				culture = event_target:noble_province
			}
		}
		else = {
			define_heir = {
				age = 10
				dynasty = Hakurei
				hidden = yes
				adm = 1
				dip = 1
				mil = 2
				female = yes
			}
		}
		add_devotion = -5
		add_prestige = 10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}

	option = {
		name = touhou_theocracy.1.j		# True Heir of Moriya
		trigger = {
			OR = {
				tag = MRY
				tag = GNK
			}
		}

		set_country_flag = theo_local_noble_flag # USED IN DEVOTION.TXT
		if = {
			limit = {
				has_saved_event_target = noble_province
			}
			define_heir = {
				age = 10
				dynasty = Moriya
				hidden = yes
				adm = 1
				dip = 1
				mil = 2
				female = yes
				culture = event_target:noble_province
			}
		}
		else = {
			define_heir = {
				age = 10
				dynasty = Moriya
				hidden = yes
				adm = 1
				dip = 1
				mil = 2
				female = yes
			}
		}
		add_devotion = -5
		add_prestige = 10
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
	option = {
		name = theocracy.1.i		# A Noble of House von Wittelsbach
		trigger = {
			has_country_flag = KOL_secondogeniture_of_BAV
		}
		if = {
			limit = { has_government_attribute = can_see_theocratic_heir_stats }
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					dynasty = event_target:probably_bavaria
					culture = event_target:probably_bavaria
					religion = event_target:probably_bavaria
				}
			}
			else = {
				define_heir = {
					age = 35
					dynasty = event_target:probably_bavaria
					culture = event_target:probably_bavaria
					religion = event_target:probably_bavaria
				}
			}
		}
		else = {
			if = {
				limit = {
					has_global_modifier_value = {
						which = female_advisor_chance
						value = 1
					}
				}
				define_heir = {
					age = 35
					female = yes
					hidden = yes
					dynasty = event_target:probably_bavaria
					culture = event_target:probably_bavaria
					religion = event_target:probably_bavaria
				}
			}
			else = {
				define_heir = {
					age = 35
					hidden = yes
					dynasty = event_target:probably_bavaria
					culture = event_target:probably_bavaria
					religion = event_target:probably_bavaria
				}
			}
		}
	}
	option = {
		name = theocracy.1.j		# Let the Lottery decide!
		trigger = {
			NOT = { has_country_flag = KOL_secondogeniture_of_BAV }
		}
		random_list = {
			1 = {
				custom_tooltip = theocracy.1.j.a
				set_country_flag = theo_local_noble_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_saved_event_target = noble_province
						NOT = {
							has_global_modifier_value = {
								which = female_advisor_chance
								value = 1
							}
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						culture = event_target:noble_province
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = noble_province
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						female = yes
						culture = event_target:noble_province
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = noble_province
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						female = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				custom_tooltip = theocracy.1.j.b
				set_country_flag = theo_foreign_noble_flag # USED IN DEVOTION.TXT
				random_neighbor_country = { 
					limit = {
						government = monarchy
						has_regency = no
						religion = ROOT
					}
					ROOT = { 
						if = {
							limit = {
								NOT = {
									has_global_modifier_value = {
										which = female_advisor_chance
										value = 1
									}
								}
							}
							define_heir = { 
								dynasty = PREV 
								age = 35
								culture = PREV
								hidden = yes
							} 
						}
						else = {
							define_heir = { 
								dynasty = PREV 
								age = 35
								culture = PREV
								female = yes
								hidden = yes
							} 
						}
					}
					add_opinion = { who = ROOT modifier = opinion_theocracy_noble }
				}
			}
			1 = {
				custom_tooltip = theocracy.1.j.c
				set_country_flag = theo_merchants_son_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_saved_event_target = burgher_province
						NOT = {
							has_global_modifier_value = {
								which = female_advisor_chance
								value = 1
							}
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						culture = event_target:burgher_province
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = burgher_province
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						female = yes
						culture = event_target:burgher_province
					}
				}
				else_if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				custom_tooltip = theocracy.1.j.d
				set_country_flag = theo_talented_theologian_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_saved_event_target = church_province
						NOT = {
							has_global_modifier_value = {
								which = female_advisor_chance
								value = 1
							}
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						culture = event_target:church_province
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = church_province
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						female = yes
						culture = event_target:church_province
					}
				}
				else_if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				trigger = {
					NOT = { religion_group = muslim }
				}
				custom_tooltip = theocracy.1.j.e
				set_country_flag = theo_local_preacher_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_saved_event_target = church_province
						NOT = {
							has_global_modifier_value = {
								which = female_advisor_chance
								value = 1
							}
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						culture = event_target:church_province
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = church_province
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						hidden = yes
						female = yes
						culture = event_target:church_province
					}
				}
				else_if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				trigger = {
					religion = catholic
				}
				custom_tooltip = theocracy.1.j.f
				set_country_flag = theo_papal_protege_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_saved_event_target = papal_protoge_country
						NOT = {
							has_global_modifier_value = {
								which = female_advisor_chance
								value = 1
							}
						}
					}
					define_heir = {
						age = 35
						culture = event_target:papal_protoge_country
						hidden = yes
					}
				}
				else_if = {
					limit = {
						has_saved_event_target = papal_protoge_country
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						culture = event_target:papal_protoge_country
						female = yes
						hidden = yes
					}
				}
				else_if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				trigger = {
					religion_group = muslim
				}
				custom_tooltip = theocracy.1.j.g
				set_country_flag = theo_imam_khatib_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
			1 = {
				trigger = {
					OR = {
						religion = reformed
						religion = protestant
					}
				}
				custom_tooltip = theocracy.1.j.h
				set_country_flag = theo_influential_reformer_flag # USED IN DEVOTION.TXT
				if = {
					limit = {
						has_global_modifier_value = {
							which = female_advisor_chance
							value = 1
						}
					}
					define_heir = {
						age = 35
						female = yes
						hidden = yes
					}
				}
				else = {
					define_heir = {
						age = 35
						hidden = yes
					}
				}
			}
		}
		add_devotion = 5
		clr_country_flag = in_theocracy_heir_selection
		custom_tooltip = theocracy.1.tt
	}
}

country_event = {	#Incident - Non-Gensokyan declares war upon Gensokyo
	id = touhou_theocracy.2
	title = touhou_theocracy.2.t
	desc = touhou_theocracy.2.desc
	picture = SHRINE_eventPicture
	
	is_triggered_only = yes
	
	option = {		#Defender will call now the shrine maiden
		name = touhou_theocracy.2.a
		custom_tooltip = touhou_theocracy.2.a.tt
		
		ai_chance = {
			factor = 100
		}
	}
}

# TODO rework it later by converting the whole call to arm thing into a decision
# The decision is unlocked as soon you are a defender in a war against with enemies
# from another continent.
#country_event = {	#Incident - Gensokyo get attacked by none-gensokyan
#	id = touhou_theocracy.3
#	title = touhou_theocracy.3.t
#	desc = touhou_theocracy.3.desc
#	picture = SHRINE_eventPicture
#
#	trigger = {
#		capital_scope = {
#			continent = gensokyo_continent
#		}
#		any_known_country = {
#			capital_scope = {
#				th_gensokyo_or_moon_continent = no
#			}
#			is_in_war = {
#				attacker_leader = THIS
#				defender_leader = ROOT
#			}
#			NOT = { religion_group = Touhou }
#			NOT = { has_country_flag = th_already_triggered_call_for_defensive_for_@ROOT }
#		}
#		if = {
#			limit = {
#				NOT = { has_government_attribute = enables_call_to_defensive_war }
#			}
#			any_known_country = {
#				NOT = { is_rival = ROOT }
#				NOT = { is_enemy = ROOT }
#				has_government_attribute = enables_call_to_defensive_war
#				NOT = { war_with = ROOT }
#				NOT = { has_country_flag = th_declined_help_for_@ROOT }
#				NOT = { has_country_flag = th_gets_asked_to_defend }
#				same_continent = ROOT
#				is_free_or_tributary_trigger = yes
#				NOT = {	#Shrine maiden shouldn't be called into a war with somebody they are either fighting already or against somebody they are allied with
#					any_country = {
#						capital_scope = {
#							th_gensokyo_or_moon_continent = no
#						}
#						OR = {
#							war_with = PREV
#							alliance_with = PREV
#						}
#						is_in_war = {
#							attacker_leader = THIS
#							defender_leader = ROOT
#						}
#					}
#				}
#			}
#		}
#		NOT = { has_country_flag = th_caused_call_to_defense }
#	}
#
#	mean_time_to_happen = {
#		months = 1
#	}
#
#	immediate = {
#		hidden_effect = {
#			set_country_flag = th_caused_call_to_defense
#			if = {
#				limit = {
#					NOT = { has_government_attribute = enables_call_to_defensive_war }
#				}
#				every_known_country = {
#					limit = {
#						NOT = { is_rival = ROOT }
#						NOT = { is_enemy = ROOT }
#						has_government_attribute = enables_call_to_defensive_war
#						NOT = { war_with = ROOT }
#						NOT = { has_country_flag = th_declined_help_for_@ROOT }
#						NOT = { has_country_flag = th_gets_asked_to_defend }
#						same_continent = ROOT
#						is_free_or_tributary_trigger = yes
#						NOT = {	#Shrine maiden shouldn't be called into a war with somebody they are either fighting already or against somebody they are allied with
#							any_country = {
#								capital_scope = {
#									th_gensokyo_or_moon_continent = no
#								}
#								OR = {
#									war_with = PREV
#									alliance_with = PREV
#								}
#								is_in_war = {
#									attacker_leader = THIS
#									defender_leader = ROOT
#								}
#							}
#						}
#					}
#					set_country_flag = th_gets_asked_to_defend
#				}
#			}
#			random_known_country = {
#				limit = {
#					NOT = { religion_group = Touhou }
#					capital_scope = {
#						th_gensokyo_or_moon_continent = no
#					}
#					is_in_war = {
#						attacker_leader = THIS
#						defender_leader = ROOT
#					}
#					NOT = { has_country_flag = th_already_triggered_call_for_defensive_for_@ROOT }
#				}
#				set_country_flag = th_already_triggered_call_for_defensive_for_@ROOT
#				country_event = {
#					id = touhou_theocracy.2
#				}
#			}
#		}
#	}
#	
#	option = {		#Call the Shrine Maidens for help
#		name = touhou_theocracy.3.a
#		trigger = {
#			NOT = { has_government_attribute = enables_call_to_defensive_war }
#		}
#		custom_tooltip = touhou_theocracy.3.a.tt
#		hidden_effect = {
#			every_known_country = {
#				limit = {
#					has_country_flag = th_gets_asked_to_defend
#				}
#				country_event = { id = touhou_theocracy.4 }
#			}
#		}
#		ai_chance = {
#			factor = 100
#		}
#	}
#	
#	option = {		#If the defender is already shrine theocracy
#		name = touhou_theocracy.3.b
#		trigger = {
#			has_government_attribute = enables_call_to_defensive_war
#		}
#		add_devotion = 15
#		add_prestige = 15
#		if = {
#			limit = {
#				NOT = { has_country_modifier = th_defense_of_gensokyo }
#			}
#			add_country_modifier = { 
#				name = th_defense_of_gensokyo
#				duration = -1  
#				desc = th_defense_of_gensokyo_tooltip
#			}
#		}
#		else = {
#			add_army_tradition = 20
#		}
#	}
#}

#country_event = {	#Incident - The Shrine Maiden get the call to arms
#	id = touhou_theocracy.4
#	title = touhou_theocracy.4.t
#	desc = touhou_theocracy.4.desc
#	picture = SHRINE_eventPicture
#	
#	is_triggered_only = yes
#
#	trigger = {
#		is_free_or_tributary_trigger = yes
#	}
#	
#	option = {
#		name = "touhou_theocracy.4.a"
#		add_opinion = {
#			who = FROM
#			modifier = th_defense_of_gensokyo_opinion
#		}
#		hidden_effect = {
#			set_country_flag = th_accepted_help_for_@FROM
#			clr_country_flag = th_gets_asked_to_defend
#		}
#		every_known_country = {
#			limit = {
#				religion_group = Touhou
#				capital_scope = { th_gensokyo_or_moon_continent = yes }
#			}
#			add_opinion = {
#				who = THIS
#				modifier = th_defender_of_gensokyo
#			}
#		}
#				
#		FROM = {
#			add_opinion = {
#				who = ROOT
#				modifier = th_defense_of_gensokyo_opinion
#			}
#		}
#		join_all_defensive_wars_of = FROM
#		add_devotion = 15
#		add_prestige = 15
#		mry_add_faith_power = {
#			value = 25
#		}
#		if = {
#			limit = {
#				NOT = { has_country_modifier = th_defense_of_gensokyo }
#			}
#			add_country_modifier = { 
#				name = th_defense_of_gensokyo
#				duration = -1  
#				desc = th_defense_of_gensokyo_tooltip
#			}
#		}
#
#		ai_chance = {
#			factor = 100
#			modifier = {
#				factor = 0
#				OR = {
#					is_bankrupt = yes
#					war_exhaustion = 10
#				}
#			}
#			modifier = {
#				factor = 0
#				th_is_subject_other_than_tributary_trigger = yes
#			}
#			modifier = {
#				factor = 0
#				NOT = {
#					has_opinion = {
#						who = FROM
#						value = -50
#					}
#				}
#			}
#		}
#	}
#	
#	option = { # stay out of this
#		name = "touhou_theocracy.4.b"
#		add_prestige = -25
#		add_devotion = -25
#		add_country_modifier = {
#			name = dishonoured_alliance
#			duration = 3650
#		}
#		mry_add_faith_power = {
#			value = -25
#		}
#		hidden_effect = {
#			set_country_flag = th_declined_help_for_@FROM
#			clr_country_flag = th_gets_asked_to_defend
#		}
#		ai_chance = { 
#			factor = 100
#			modifier = {
#				factor = 0
#				OR = {
#					is_bankrupt = no
#					NOT = { war_exhaustion = 10 }
#				}
#			}
#			modifier = {
#				factor = 0
#				th_is_subject_other_than_tributary_trigger = yes
#			}
#		}
#	}	
#	
#	option = { # stay out of this
#		name = "touhou_theocracy.4.c"
#		trigger = {
#			ai = yes
#			th_is_subject_other_than_tributary_trigger = yes
#		}
#		hidden_effect = {
#			set_country_flag = th_declined_help_for_@FROM
#			clr_country_flag = th_gets_asked_to_defend
#		}
#		ai_chance = { 
#			factor = 1000
#			modifier = {
#				factor = 0
#				OR = {
#					is_bankrupt = no
#					NOT = { war_exhaustion = 10 }
#				}
#			}
#		}
#	}	
#}

#country_event = {	#Incident - Attacked Gensokyan finishes war with invader
#	id = touhou_theocracy.5
#	title = touhou_theocracy.5.t
#	desc = touhou_theocracy.5.desc
#	picture = SHRINE_eventPicture
#	
#	mean_time_to_happen = {
#		months = 1
#	}
#	
#	hidden = yes
#	
#	trigger = {
#		has_country_flag = th_caused_call_to_defense
#		NOT = {
#			any_country = {
#				capital_scope = {
#					th_gensokyo_or_moon_continent = no
#				}
#				is_in_war = {
#					attacker_leader = THIS
#					defender_leader = ROOT
#				}
#				NOT = { religion_group = Touhou }
#				has_country_flag = th_already_triggered_call_for_defensive_for_@ROOT
#			}
#		}
#	}
#	
#	option = {		#Delete flag
#		name = touhou_theocracy.5.a
#		hidden_effect = {
#			clr_country_flag = th_caused_call_to_defense
#			every_country = {
#				limit = {
#					has_country_flag = th_already_triggered_call_for_defensive_for_@ROOT
#				}
#				clr_country_flag = th_already_triggered_call_for_defensive_for_@ROOT
#			}
#			every_country = {
#				limit = {
#					has_country_flag = th_declined_help_for_@ROOT
#				}
#				clr_country_flag = th_declined_help_for_@ROOT
#			}
#			every_country = {
#				limit = {
#					has_country_flag = th_accepted_help_for_@ROOT
#				}
#				clr_country_flag = th_accepted_help_for_@ROOT
#			}
#		}
#		ai_chance = {
#			factor = 100
#		}
#	}
#}

#country_event = {	#Defense of Gensokyo is over
#	id = touhou_theocracy.6
#	title = touhou_theocracy.6.t
#	desc = touhou_theocracy.6.desc
#	picture = SHRINE_eventPicture
#	
#	mean_time_to_happen = {
#		months = 1
#	}
#	
#	trigger = {
#		has_country_modifier = th_defense_of_gensokyo
#		OR = {
#			NOT = {
#				any_country = {
#					has_country_flag = th_caused_call_to_defense
#				}
#			}
#			NOT = { is_in_war = { defenders = ROOT } }
#		}
#	}
#	
#	option = {
#		name = touhou_theocracy.6.a
#		remove_country_modifier = th_defense_of_gensokyo			
#	}
#}