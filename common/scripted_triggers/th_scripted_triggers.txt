###DANMAKU DUEL COUNTER###
th_num_of_won_danmaku_duels = {
	if = {
		limit = { NOT = { has_country_flag = th_danmaku_counts_won_danmaku_fights } }
		custom_trigger_tooltip = {
			tooltip = th_num_of_won_danmaku_duels_tt
			has_country_flag = th_danmaku_counts_won_danmaku_fights
		}
	}
	else = {
		check_variable = {
			which = th_danmaku_won_danmaku_fights
			value = $amount$
		}
	}
}

###IS BUDDHIST###
th_is_buddhist = {
	OR = {
		religion = th_buddhist
		religion = buddhism
		religion = mahayana
		religion = vajrayana
		AND = {
			religion = hinduism
			owner = {
				has_personal_deity = buddha	
			}						
		}
		AND = {
			religion = shamanism
			owner = {
				has_unlocked_cult = buddhism_cult	
			}				
		}
	}
}

###IS TAOIST / CONFUCIANIST###
th_is_taoist_or_confucianist = {
	OR = {
		religion = th_taoist
		religion = confucianism
	}
}

###IS JAPAENSE OR GENSOKYAN###
th_is_gensokyan_or_japanese = {
	OR = {
		culture_group = japanese_g
		th_is_touhou_culture_group = yes
	}
}

th_province_is_or_accepts_culture = {
	OR = {
		has_owner_culture = yes
		has_owner_accepted_culture = yes
	}
}

th_secondary_religion_group = {
	[[christian]
		OR = {
			secondary_religion = catholic
			secondary_religion = hussite
			secondary_religion = coptic
			secondary_religion = orthodox
			secondary_religion = protestant
			secondary_religion = reformed
			secondary_religion = anglican
		}
	]
	[[muslim]
		OR = {
			secondary_religion = sunni
			secondary_religion = shiite
			secondary_religion = ibadi
		}
	]
	[[eastern]
		OR = {
			secondary_religion = buddhism
			secondary_religion = vajrayana
			secondary_religion = mahayana
			secondary_religion = confucianism
			secondary_religion = shinto
		}
	]
	[[dharmic]
		OR = {
			secondary_religion = hinduism
			secondary_religion = sikhism
		}
	]
	[[pagan]
		OR = {
			secondary_religion = animism
			secondary_religion = shamanism
			secondary_religion = totemism
			secondary_religion = inti
			secondary_religion = nahuatl
			secondary_religion = mesoamerican_religion
			secondary_religion = norse_pagan_reformed
			secondary_religion = tengri_pagan_reformed
			secondary_religion = dreamtime
		}
	]
	[[jewish_group]
		secondary_religion = jewish
	]
	[[zoroastrian_group]
		secondary_religion = zoroastrian
	]
	[[Touhou]
		OR = {
			secondary_religion = th_hakureishinto
			secondary_religion = th_moriyashinto
			secondary_religion = th_oldhakurei
			secondary_religion = th_shinkism
			secondary_religion = th_christian
			secondary_religion = th_buddhist
			secondary_religion = th_taoist
		}
	]
	[[lunarian_religion_g]
		secondary_religion = th_lunarian_religion
	]
}

th_has_harmonized_with_christian_harmonized = {
	OR = {
		has_harmonized_with = catholic
		has_harmonized_with = protestant
		has_harmonized_with = reformed
		has_harmonized_with = anglican
		has_harmonized_with = orthodox
		has_harmonized_with = coptic
		has_harmonized_with = hussite
	}
}

th_has_harmonized_with_muslim_harmonized = {
	OR = {
		has_harmonized_with = sunni
		has_harmonized_with = shiite
		has_harmonized_with = ibadi
	}
}

th_has_harmonized_with_dharmic_harmonized = {
	OR = {
		has_harmonized_with = hinduism
		has_harmonized_with = sikhism
	}
}

th_has_harmonized_with_eastern_harmonized = {
	OR = {
		has_harmonized_with = buddhism
		has_harmonized_with = vajrayana
		has_harmonized_with = mahayana
		has_harmonized_with = shinto
		has_harmonized_with = confucianism
	}
}

th_has_harmonized_with_pagan_harmonized = {
	OR = {
		has_harmonized_with = shamanism
		has_harmonized_with = totemism
		has_harmonized_with = nahuatl
		has_harmonized_with = inti
		has_harmonized_with = norse_pagan_reformed
		has_harmonized_with = animism
		has_harmonized_with = dreamtime
		has_harmonized_with = mesoamerican_religion
		has_harmonized_with = tengri_pagan_reformed
	}
}

th_has_harmonized_with_jewish_group_harmonized = {
	has_harmonized_with = jewish
}

th_has_harmonized_with_zoroastrian_group_harmonized = {
	has_harmonized_with = zoroastrian
}

th_has_harmonized_with_lunarian_religion_g_harmonized = {
	has_harmonized_with = th_lunarian_religion
}

th_has_harmonized_with_Touhou_harmonized = {
	OR = {
		has_harmonized_with = th_hakureishinto
		has_harmonized_with = th_oldhakurei
		has_harmonized_with = th_moriyashinto
		has_harmonized_with = th_taoist
		has_harmonized_with = th_buddhist
		has_harmonized_with = th_christian
		has_harmonized_with = th_shinkism
	}
}

th_province_is_or_accepts_religion_group = {
	custom_trigger_tooltip = {
		tooltip = province_is_or_accepts_$religion_group$_tt
		OR = {
			AND = {
				religion_group = $religion_group$
				has_owner_religion = yes
			}
			AND = {
				owner = { th_secondary_religion_group = { $religion_group$ = yes } }
				OR = {
					religion_group = $religion_group$
					has_owner_religion = yes
				}
			}
			AND = {
				owner = { th_has_harmonized_with_$religion_group$_harmonized = yes }
				OR = {
					has_owner_religion = yes
					religion_group = $religion_group$
				}
			}
		}
	}
}

###IS CHRISTIAN###
th_is_christian = {
	OR = {
		th_province_is_or_accepts_religion_group = {
			religion_group = christian
		}
		AND = {
			religion = th_christian
			has_owner_religion = yes
		}
	}
}

###CAN USE DHARMIC###
th_can_use_dharmic_monuments = {
	OR = {
		th_province_is_or_accepts_religion_group = {
			religion_group = dharmic
		}
		custom_trigger_tooltip = {
			tooltip = th_can_use_dharmic_monuments_tt
			owner = { has_country_flag = hig_can_use_dharmic_monuments }
		}
	}
}

###CAN USE CHINESE###
th_can_use_chinese_monuments = {
	OR = {
		culture_group = east_asian
		custom_trigger_tooltip = {
			tooltip = th_can_use_chinese_monuments_tt
			owner = { has_country_flag = th_can_use_chinese_monuments }
		}
	}
}

###IS SHINTO###
th_is_shinto = {
	OR = {
		religion = th_hakureishinto
		religion = th_moriyashinto
		religion = th_oldhakurei
		religion = shinto
	}
}

#Buddhism is its own can of worms due to the so many aspects of it
#This was one of the few moments where it was almost worth considering putting Buddhism in its own religion group - almost
th_province_is_buddhist_or_accepts_buddhism = {
	OR = {
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_at
			OR = {
				AND = {
					religion = buddhism
					OR = {
						has_owner_religion = yes
						owner = { has_harmonized_with = buddhism }
						secondary_religion = buddhism
					}
				}
				AND = {
					religion = vajrayana
					OR = {
						has_owner_religion = yes
						owner = { has_harmonized_with = vajrayana }
						secondary_religion = vajrayana
					}
				}
				AND = {
					religion = mahayana
					OR = {
						has_owner_religion = yes
						owner = { has_harmonized_with = mahayana }
						secondary_religion = mahayana
					}
				}
				AND = {
					religion = th_buddhist
					OR = {
						has_owner_religion = yes
						owner = { has_harmonized_with = th_buddhist }
						secondary_religion = th_buddhist
					}
				}
			}
		}
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_bt
			owner = {
				OR = {
					has_harmonized_with = buddhism
					has_harmonized_with = vajrayana
					has_harmonized_with = mahayana
					has_harmonized_with = th_buddhist
				}
			}
			has_owner_religion = yes
		}
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_ct
			owner = {
				OR = {
					secondary_religion = buddhism
					secondary_religion = vajrayana
					secondary_religion = mahayana
					secondary_religion = th_buddhist
				}
			}
			has_owner_religion = yes
		}
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_dt
			religion = shinto
			has_owner_religion = yes
		}
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_et
			owner = { has_personal_deity = buddha }
			has_owner_religion = yes
		}
		custom_trigger_tooltip = {
			tooltip = province_is_buddhist_or_accepts_buddhism_ft
			owner = { has_adopted_cult = buddhism_cult }
			has_owner_religion = yes
		}
		#For the case the province has a religion which the player has already harmonized with and cannot convert
		#It's a hidden trigger because the tooltip is already super flooded and it is incredibly niche
		hidden_trigger = {
			owner = {
				OR = {
					has_harmonized_with = buddhism
					has_harmonized_with = vajrayana
					has_harmonized_with = mahayana
				}
				has_harmonized_with = ROOT
			}
		}
	}
}

###PRIVILEGES###
#Supports the following privileges
# th_estate_nobles_third_eye
# th_estate_burghers_arctic_development
# th_estate_burghers_mass_marine_conscription
# th_estate_burghers_elite_marines
# th_estate_burghers_naval_reinforcement
#Use when you need a tooltip
th_has_unlocked_privilege = {
	custom_trigger_tooltip = {
		tooltip = th_has_unlocked_$estate_privilege$_tt
		has_country_flag = unlocked_privilege_$estate_privilege$_privilege
	}
}
#Supports all reforms
#th_has_unlocked_privilege_no_tooltip = {	#No longer really needed, use has_unlocked_estate_privilege instead
#	has_country_flag = th_unlocked_$estate_privilege$_privilege
#}

###MRY SHINTO TRIGGERS###

th_mry_shinto_has_sanae_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_hakureis_power
		has_country_modifier = th_mry_shinto_keikis_idols
		has_country_modifier = th_mry_shinto_kishin_lunar_naval
	}
}

th_mry_shinto_has_suwako_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_sukunas_envoys
		has_country_modifier = th_mry_shinto_hinas_misfortune
		has_country_modifier = th_mry_shinto_hecatias_hell_workers
	}
}

th_mry_shinto_has_kanako_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_junkos_fury
		has_country_modifier = th_mry_shinto_shinkis_merchants
		has_country_modifier = th_mry_shinto_satoris_influence
	}
}

###EIT variable###

th_eit_has_max_aggressors = {
	check_variable = {
		which = th_eit_aggressor_counter
		value = 5
	}
}

th_eit_has_at_least_one_aggressor = {
	check_variable = {
		which = th_eit_aggressor_counter
		value = 1
	}
}

###FUJ variable###
th_fuj_has_level = {
	check_variable = {
		which = fuj_mokou_level
		value = $level$
	}
}

###HIG has any revokable reform###
th_hig_has_revokable_reform_active = {
	OR = {
		has_estate_privilege = th_estate_yama_eternal_peace
		has_estate_privilege = th_estate_yama_expand_roles
		has_estate_privilege = th_estate_yama_centralize_gensokyan_authority
		has_estate_privilege = th_estate_yama_establish_laws_of_war
		has_estate_privilege = th_estate_yama_reform_the_judicative
		has_estate_privilege = th_estate_yama_appoint_executor
		has_estate_privilege = th_estate_yama_enforce_peace
		has_estate_privilege = th_estate_yama_establish_lecturing
		has_estate_privilege = th_estate_yama_internal_higan_reform
		has_estate_privilege = th_estate_yama_regulate_conquest
	}
}

###PLEDGED TO RELIGION###
th_religious_pledged = {
	custom_trigger_tooltip = {
		tooltip = th_pledged_to_religion_tt
		OR = {
			has_country_flag = th_pledged_to_religion_to_@$tag$
			AND = {
				is_subject_of = $tag$
				has_country_modifier = th_subjugated_in_penance
			}
		}
	}
}

###ROOT HAS WON A DANMAKU DUEL AGAINST THE SCOPE###
th_has_lost_danmaku_duel_against_root = {
	custom_trigger_tooltip = {
		tooltip = th_has_lost_danmaku_duel_against_root_tt
		has_country_flag = th_danmaku_duel_lost_against_@ROOT
	}
}

###ROOT HAS ASSERTED DOMINANCE AGAINST THE TARGET###
th_has_been_asserted_dominance_by_root = {	
	custom_trigger_tooltip = {
		tooltip = th_has_been_asserted_in_dominance
		has_country_flag = th_asserted_dominance_by_@ROOT
	}
}

###IS OR WAS TAG###
th_is_or_was_tag = {
	OR = {
		tag = $tag$
		was_tag = $tag$
	}
}

###HELLFAIRY MECHANIC###
th_hellfairy_has_no_stack = {
	NOT = { has_province_modifier = th_hellfairy_berserk_1 }
	NOT = { has_province_modifier = th_hellfairy_berserk_2 }
	NOT = { has_province_modifier = th_hellfairy_berserk_3 }
	NOT = { has_province_modifier = th_hellfairy_berserk_4 }
	NOT = { has_province_modifier = th_hellfairy_berserk_5 }
	NOT = { has_province_modifier = th_hellfairy_berserk_6 }
	NOT = { has_province_modifier = th_hellfairy_berserk_7 }
	NOT = { has_province_modifier = th_hellfairy_berserk_8 }
	NOT = { has_province_modifier = th_hellfairy_berserk_9 }
	NOT = { has_province_modifier = th_hellfairy_berserk_10 }
}

th_hellfairy_had_stack_for_duration = {
	OR = {
		had_province_flag = { flag = th_hellfairy_province_has_stack_1 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_2 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_3 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_4 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_5 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_6 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_7 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_8 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_9 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_10 days = $days$ }
	}
}

th_hellfairy_has_not_reached_maximum = {
	NOT = { has_province_modifier = th_hellfairy_berserk_10 }
}

th_hellfairy_has_any_flag = {
	OR = {
		has_province_flag = th_hellfairy_province_has_berserk
		has_province_flag = th_hellfairy_province_has_stack_1
		has_province_flag = th_hellfairy_province_has_stack_2
		has_province_flag = th_hellfairy_province_has_stack_3
		has_province_flag = th_hellfairy_province_has_stack_4
		has_province_flag = th_hellfairy_province_has_stack_5
		has_province_flag = th_hellfairy_province_has_stack_6
		has_province_flag = th_hellfairy_province_has_stack_7
		has_province_flag = th_hellfairy_province_has_stack_8
		has_province_flag = th_hellfairy_province_has_stack_9
		has_province_flag = th_hellfairy_province_has_stack_10
	}
}

th_hellfairy_has_positive_berserk = {
	OR = {
		has_province_flag = th_hellfairy_province_has_stack_4
		has_province_flag = th_hellfairy_province_has_stack_5
		has_province_flag = th_hellfairy_province_has_stack_6
		has_province_flag = th_hellfairy_province_has_stack_7
		has_province_flag = th_hellfairy_province_has_stack_8
		has_province_flag = th_hellfairy_province_has_stack_9
		has_province_flag = th_hellfairy_province_has_stack_10
	}
}

###SFF TRIGGER###

th_sff_compare_sun_garden_power = {
	check_variable = {
		which = sff_sun_garden_counter
		value = $value$
	}
}

th_sff_compare_flower_count = {
	check_variable = {
		which = sff_flower_counter
		value = $value$
	}
}

###MERC COMPANIES###
th_is_allowed_to_recruit_mercenaries = {
	custom_trigger_tooltip = {
		tooltip = is_allowed_to_recruit_mercenaries_tt
		NOT = { has_idea_group = LEM_ideas }
		NOT = { has_idea_group = LCU_ideas }
		NOT = { has_country_flag = th_disabled_mercenaries }
		NOT = { has_country_flag = scr_professional_meiling_troops_only }
		NOT = { has_country_modifier = dan_sca_refocus_on_personal_armies }
	}
}

###Supports following merc companies
# merc_th_level_titania
# merc_th_goliath_doll
# merc_th_level_leviathan
# merc_th_yukaris_royal_guard
# merc_th_law_enforcers_of_higan
th_unlocked_mercenary_company = {
	custom_trigger_tooltip = {
		tooltip = th_has_unlocked_$mercenary_company$_tt
		has_country_flag = th_unlock_$mercenary_company$
	}
}

###IS NOT AN OCCUPIED PROVINCE###
th_province_is_not_occupied = {
	NOT = {
		any_country = {
			controls = $province$
			NOT = { owns = $province$ }
		}
	}
}

###RELIGIOUS WARS###
th_has_won_the_religious_war = {
	custom_trigger_tooltip = {
		tooltip = obj_religious_league_war_on_winning_side_tooltip
		has_country_flag = religious_league_war_on_winning_side
	}
}

###WAS INFLUENCED###
#Make sure you check if Rights of Man or Emperor is active because Great Powers is not base game
#Changed to a new modifier so Right of Man is no longer needed
th_has_been_influenced_by_root = {
	custom_trigger_tooltip = {
		tooltip = th_has_been_influenced_by_root_tt
		has_opinion_modifier = {
			who = ROOT
			modifier = th_great_power_influence
		}
	}
}

###RECEIVED GIFT###
#Not used now. But I keep it for future use
th_has_received_gift_from_root = {
	custom_trigger_tooltip = {
		tooltip = th_has_received_gift_from_root_tt
		has_opinion_modifier = {
			who = ROOT
			modifier = sent_gift
		}
	}
}

###MRY FAITH POWER###
mry_uses_faith_power = {
	custom_trigger_tooltip = {
		tooltip = mry_uses_faith_power_tt
		religion = th_moriyashinto
		has_reform = Gensokyan_shrine_theocracy
		has_country_flag = mry_moriya_curia_active
	}
}

mry_num_of_miracles_caused = {
	if = {
		limit = { mry_uses_faith_power = yes }
		check_variable = {
			which = mry_miracle_counter
			value = $amount$
		}
	}
	else = {
		custom_trigger_tooltip = {
			tooltip = mry_num_of_miracles_caused_tt
			mry_uses_faith_power = yes
		}
	}
}

###NET CUISINE MECHANIC###
net_uses_cuisine_mechanic = {
	custom_trigger_tooltip = {
		tooltip = net_uses_cuisine_mechanic_tt
		has_country_flag = net_has_cuisine_mechanic
	}
}

net_has_cuisine_unlocked = {
	[[cuisine]
		custom_trigger_tooltip = {
			tooltip = net_has_$cuisine$_cuisine_unlocked_tt
			has_country_flag = net_unlocked_$cuisine$_cuisine
		}
	]
}

net_has_not_cuisine_active = {
	[[cuisine]
		custom_trigger_tooltip = {
			tooltip = net_has_not_$cuisine$_cuisine_active
			NOT = { has_country_flag = net_$cuisine$_cuisine_active }
		}
	]
}

net_has_cuisine_flag_with_no_modifier = {
	[[cuisine]
		custom_trigger_tooltip = {
			tooltip = net_has_not_$cuisine$_cuisine_active
			has_country_flag = net_$cuisine$_cuisine_active
			NOT = { has_country_modifier = net_$cuisine$_cuisine_modifier }
		}
	]
}

###MIM MAGIC SCHOOL MECHANIC###
#conjuration
#evocation
#divination
#transmutation
#enchanting
#abjuration
mim_has_not_reached_max_level_of_school = {
	NOT = {		
		check_variable = {
			which = th_magic_school_$school$
			value = 4
		}
	}
}
mim_has_reached_max_level_of_school = {
	check_variable = {
		which = th_magic_school_$school$
		value = 4
	}
}

###LCU ACCEPTED CULTURES###
#Supports the following cultures
# Heavenish
# Netherlandish
# Eientei
# Higanean
lcu_is_not_accepted_province_culture = {
	OR = {
		owner = { NOT = { has_country_flag = lcu_accepts_Heavenish_culture } }
		NOT = { culture = Heavenish }
	}
	OR = {
		owner = { NOT = { has_country_flag = lcu_accepts_Netherlandish_culture } }
		NOT = { culture = Netherlandish }
	}
	OR = {
		owner = { NOT = { has_country_flag = lcu_accepts_Eientei_culture } }
		NOT = { culture = Eientei }
	}
	OR = {
		owner = { NOT = { has_country_flag = lcu_accepts_Higanean_culture } }
		NOT = { culture = Higanean }
	}
}

lcu_is_accepted_province_culture = {
	OR = {
		AND = {
			owner = { has_country_flag = lcu_accepts_Heavenish_culture }
			culture = Heavenish
		}
		AND = {
			owner = { has_country_flag = lcu_accepts_Netherlandish_culture }
			culture = Netherlandish
		}
		AND = {
			owner = { has_country_flag = lcu_accepts_Eientei_culture }
			culture = Eientei
		}
		AND = {
			owner = { has_country_flag = lcu_accepts_Higanean_culture }
			culture = Higanean
		}
	}
}

th_can_convert_on_colonization_religion_check = {
	religion = $religion$
	has_country_flag = th_enabled_$religion$_converting_on_colonization
}

th_can_convert_on_colonization = {
	OR = {
		has_country_flag = th_enabled_converting_on_colonization
		AND = {
			NOT = { has_country_flag = th_enabled_converting_on_colonization }
			OR = {
				th_can_convert_on_colonization_religion_check = { religion = th_hakureishinto }
				th_can_convert_on_colonization_religion_check = { religion = th_taoist }
				th_can_convert_on_colonization_religion_check = { religion = th_buddhist }
				th_can_convert_on_colonization_religion_check = { religion = th_moriyashinto }
				th_can_convert_on_colonization_religion_check = { religion = th_oldhakurei }
				th_can_convert_on_colonization_religion_check = { religion = th_shinkism }
				th_can_convert_on_colonization_religion_check = { religion = th_christian }
				th_can_convert_on_colonization_religion_check = { religion = th_lunarian_religion }
			}
		}
	}
	OR = {
		AND = {
			has_country_flag = th_enabled_converting_on_colonizations_for_shrines
			has_reform = Gensokyan_shrine_theocracy
		}
		NOT = { has_country_flag = th_enabled_converting_on_colonizations_for_shrines }
	}
}

th_can_request_conversion_religion_check = {
	religion = $religion$
	has_country_flag = th_enabled_$religion$_ask_conversion
}

th_can_request_conversion = {
	OR = {
		has_country_flag = th_enabled_ask_conversion
		AND = {
			NOT = { has_country_flag = th_enabled_ask_conversion }
			OR = {
				th_can_request_conversion_religion_check = { religion = th_hakureishinto }
				th_can_request_conversion_religion_check = { religion = th_taoist }
				th_can_request_conversion_religion_check = { religion = th_buddhist }
				th_can_request_conversion_religion_check = { religion = th_moriyashinto }
				th_can_request_conversion_religion_check = { religion = th_oldhakurei }
				th_can_request_conversion_religion_check = { religion = th_shinkism }
				th_can_request_conversion_religion_check = { religion = th_christian }
				th_can_request_conversion_religion_check = { religion = th_lunarian_religion }
			}
		}
	}
	OR = {
		AND = {
			has_country_flag = th_enabled_ask_conversion_for_shrines
			has_reform = Gensokyan_shrine_theocracy
		}
		NOT = { has_country_flag = th_enabled_ask_conversion_for_shrines }
	}
}

th_can_convert_claims_religion_check = {
	religion = $religion$
	has_country_flag = th_enabled_$religion$_converting_on_claim
}

th_can_convert_claims = {
	OR = {
		has_country_flag = th_enabled_converting_on_claim
		AND = {
			NOT = { has_country_flag = th_enabled_converting_on_claim }
			OR = {
				th_can_convert_claims_religion_check = { religion = th_hakureishinto }
				th_can_convert_claims_religion_check = { religion = th_taoist }
				th_can_convert_claims_religion_check = { religion = th_buddhist }
				th_can_convert_claims_religion_check = { religion = th_moriyashinto }
				th_can_convert_claims_religion_check = { religion = th_oldhakurei }
				th_can_convert_claims_religion_check = { religion = th_shinkism }
				th_can_convert_claims_religion_check = { religion = th_christian }
				th_can_convert_claims_religion_check = { religion = th_lunarian_religion }
			}
		}
	}
	OR = {
		AND = {
			has_country_flag = th_enabled_converting_on_claims_for_shrines
			has_reform = Gensokyan_shrine_theocracy
		}
		NOT = { has_country_flag = th_enabled_converting_on_claims_for_shrines }
	}
}

th_can_force_religion_on_heathens_religion_check = {
	religion = $religion$
	has_country_flag = th_can_enforce_heathen_conversion_for_$religion$_flag
}

th_can_force_religion_on_heathens = {
	OR = {
		has_country_flag = th_can_enforce_heathen_conversion_flag
		AND = {
			NOT = { has_country_flag = th_can_enforce_heathen_conversion_flag }
			OR = {
				th_can_force_religion_on_heathens_religion_check = { religion = th_hakureishinto }
				th_can_force_religion_on_heathens_religion_check = { religion = th_taoist }
				th_can_force_religion_on_heathens_religion_check = { religion = th_buddhist }
				th_can_force_religion_on_heathens_religion_check = { religion = th_moriyashinto }
				th_can_force_religion_on_heathens_religion_check = { religion = th_oldhakurei }
				th_can_force_religion_on_heathens_religion_check = { religion = th_shinkism }
				th_can_force_religion_on_heathens_religion_check = { religion = th_christian }
				th_can_force_religion_on_heathens_religion_check = { religion = th_lunarian_religion }
			}
		}
	}
	OR = {
		AND = {
			has_country_flag = th_can_enforce_heathen_conversion_flag_shrines
			has_reform = Gensokyan_shrine_theocracy
		}
		NOT = { has_country_flag = th_can_enforce_heathen_conversion_flag_shrines }
	}
}

th_is_outworld_trade_node = {
	OR = {
		province_id = 4064
		province_id = 4097
		province_id = 1191
		province_id = 2868
		province_id = 2935
		province_id = 2499
		province_id = 2021
		province_id = 730
		province_id = 1507
		province_id = 2526
		province_id = 1551
		province_id = 677
		province_id = 679
		province_id = 1371
		province_id = 1397
		province_id = 1997
		province_id = 1411
		province_id = 1376
		province_id = 684
		province_id = 700
		province_id = 4233
		province_id = 1357
		province_id = 1365
		province_id = 1361
		province_id = 1064
		province_id = 707
		province_id = 584
		province_id = 1343
		province_id = 524
		province_id = 507
		province_id = 1948
		province_id = 1340
		province_id = 504
		province_id = 1149
		province_id = 2772
		province_id = 4346
		province_id = 1334
		province_id = 1448
		province_id = 1460
		province_id = 1335
		province_id = 454
		province_id = 4341
		province_id = 377
		province_id = 358
		province_id = 464
		province_id = 1322
		province_id = 1320
		province_id = 280
		province_id = 1082
		province_id = 33
		province_id = 800
		province_id = 1536
		province_id = 809
		province_id = 1531
		province_id = 1132
		province_id = 1466
		province_id = 341
		province_id = 137
		province_id = 1110
		province_id = 153
		province_id = 262
		province_id = 134
		province_id = 61
		province_id = 1926
		province_id = 1876
		province_id = 835
		province_id = 1516
		province_id = 1500
		province_id = 1486
		province_id = 1490
		province_id = 1652
		province_id = 1975
		province_id = 45
		province_id = 1276
		province_id = 1293
		province_id = 186
		province_id = 1295
		province_id = 1298
		province_id = 1308
		province_id = 1269
	}
}

th_is_gensokyo_trade_node = {
	OR = {
		province_id = 5032
		province_id = 4982
		province_id = 5019
		province_id = 4999
		province_id = 4956
		province_id = 5090
		province_id = 4978
	}
}

th_is_not_free_merc_company = {
	ROOT = {
		NOT = { mercenary_company = merc_hakkapeliita_cavalry }
		NOT = { mercenary_company = merc_prussian_volunteer_army }
		NOT = { mercenary_company = merc_knights_templar }
		NOT = { mercenary_company = merc_swiss_guard }
		NOT = { mercenary_company = merc_large_hakkapeliita_cavalry }
		NOT = { mercenary_company = merc_guerilla_hakkapeliita_cavalry }
		NOT = { mercenary_company = merc_elite_hakkapeliita_cavalry }
		NOT = { mercenary_company = merc_mongol_banner }
		NOT = { mercenary_company = merc_swiss_canton_mercenaries }
		NOT = { mercenary_company = merc_japanese_volunteers }
		NOT = { mercenary_company = merc_militant_order_of_saint_joan }
		NOT = { mercenary_company = merc_th_yukaris_royal_guard }
		NOT = { mercenary_company = merc_th_knights_templar }
		NOT = { mercenary_company = merc_th_swiss_canton_mercenaries }
		NOT = { mercenary_company = merc_th_doppelsoeldner }
		NOT = { mercenary_company = merc_th_hessian_jaegerkorps }
		NOT = { mercenary_company = merc_th_gorkhalis }
		NOT = { mercenary_company = merc_th_dahomey_amazons }
		NOT = { mercenary_company = merc_th_goliath_doll }
		NOT = { mercenary_company = merc_th_level_titania }
		NOT = { mercenary_company = merc_th_level_leviathan }
		NOT = { mercenary_company = merc_th_law_enforcers_of_higan }
		NOT = { mercenary_company = merc_th_oni_servants }
		NOT = { mercenary_company = merc_th_hisoutensoku }
	}
}

th_has_final_tier_reforms_trigger = {
	custom_trigger_tooltip = {
		tooltip = has_completed_all_reforms_trigger_tooltip
		OR = {
			has_reform = political_absolutism_reform
			has_reform = legislative_houses_reform
			has_reform = strengthen_executive_powers_reform
			has_reform = reinforce_republican_values_reform
			has_reform = enlightened_monarchy_reform
			has_reform = emperor_of_the_revolution_reform
			has_reform = government_for_people_reform
			has_reform = president_for_life_reform
			has_reform = all_under_tengri_reform
			has_reform = proclaim_religious_head_reform
			has_reform = priestly_autonomy_reform
			has_reform = many_fingers_of_god_reform
			has_reform = religious_permanent_revolution_reform
			has_reform = religion_in_one_country_reform
			has_reform = TH_expansion_into_the_outworld_reform
			has_reform = TH_imperial_gensokyo_reform
			has_reform = TH_republic_royal_democracy
			has_reform = TH_republic_embrace_human_dictatorship
			has_reform = TH_fairies_become_absolute_monarchy_reform
			has_reform = TH_i_am_the_shrine
		}
	}
}

#Check if Peace is in Gensokyo
# Countries of the Hell regions are not checked because they are HIG's territory
# Fairies are not checked because nobody cares about them
th_has_gensokyan_peace = {
	4999 = { owner = { is_at_war = no } } #MRY
	4965 = { owner = { is_at_war = no } } #KPP
	5214 = { owner = { is_at_war = no } } #MKI
	5183 = { owner = { is_at_war = no } } #OKR
	5301 = { owner = { is_at_war = no } } #YUM
	5035 = { owner = { is_at_war = no } } #NSC
	5025 = { owner = { is_at_war = no } } #SNK
	5033 = { owner = { is_at_war = no } } #MIM
	5032 = { owner = { is_at_war = no } } #HVR
	5148 = { owner = { is_at_war = no } } #THR
	5160 = { owner = { is_at_war = no } } #GNU
	5152 = { owner = { is_at_war = no } } #SFF
	5128 = { owner = { is_at_war = no } } #RAI
	5119 = { owner = { is_at_war = no } } #SEK
	4991 = { owner = { is_at_war = no } } #EIT
	4978 = { owner = { is_at_war = no } } #HMC
	5129 = { owner = { is_at_war = no } } #KOG
	4987 = { owner = { is_at_war = no } } #MYO
	5136 = { owner = { is_at_war = no } } #KKO
	5138 = { owner = { is_at_war = no } } #SKT
	4964 = { owner = { is_at_war = no } } #TGU
	5191 = { owner = { is_at_war = no } } #KSE
	5187 = { owner = { is_at_war = no } } #YOF
	5134 = { owner = { is_at_war = no } } #AKI
	5132 = { owner = { is_at_war = no } } #OKI
	5090 = { owner = { is_at_war = no } } #FOM
	4997 = { owner = { is_at_war = no } } #FUJ
	4989 = { owner = { is_at_war = no } } #MHG
	4956 = { owner = { is_at_war = no } } #HKR
	4968 = { owner = { is_at_war = no } } #SCR
}

th_gensokyan_countries_exist = {
	1 = {
		check_variable = {
			which = th_gensokyan_counter
			value = $min$
		}
		NOT = {
			check_variable = {
				which = th_gensokyan_counter
				value = $max$
			}
		}
	}
}

th_gensokyan_countries_exist_at_least = {
	1 = {
		check_variable = {
			which = th_gensokyan_counter
			value = $num$
		}
	}
}

th_gensokyan_countries_approve_yama = {
	1 = {
		check_variable = {
			which = th_approving_gensokyan_counter
			value = $min$
		}
		NOT = {
			check_variable = {
				which = th_approving_gensokyan_counter
				value = $max$
			}
		}
	}
}

th_gensokyan_countries_approve_yama_at_least = {
	1 = {
		check_variable = {
			which = th_approving_gensokyan_counter
			value = $num$
		}
	}
}

th_has_been_lectured = {
	custom_trigger_tooltip = {
		tooltip = th_has_been_lectured_tt
		is_excommunicated = yes
	}
}

th_has_not_been_lectured = {
	custom_trigger_tooltip = {
		tooltip = th_has_not_been_lectured_tt
		is_excommunicated = no
	}
}

th_has_not_gadget_active = {
	NOT = { has_country_modifier = th_$gadget$_modifier }
}

th_has_gadget_unlocked = {
	has_country_flag = kpp_unlocked_$gadget$_gadget
}

#These should all be in th_scripted_triggers_for_submods.txt, but are here temporarily until submods are updated.

th_is_touhou_culture_group = {
	OR = {
		culture_group = Gensokyan_culture
		culture_group = moon_culture
	}
}
th_is_emperor_of_china = {
	if = {
		limit = { has_dlc = "Mandate of Heaven" }
		is_emperor_of_china = yes
	}
	else = {
		OR = {
			has_reform = Gensokyan_celestial_empire
			has_reform = celestial_empire
		}
	}
}


# HVR check Iku level

th_hvr_iku_has_level = {
	check_variable = {
		which = hvr_iku_level
		value = $level$
	}
}