#This file contains all the custom rewards of the mod
th_build_uptodate_fort = {
	if = {
		limit = {
			owner = {
				mil_tech = 24
			}
		}
		add_building = fort_18th 
	}
	else_if = {
		limit = {
			owner = {
				mil_tech = 19
			}
		}
		add_building = fort_17th 
	}
	else_if = {
		limit = {
			owner = {
				mil_tech = 14
			}
		}
		add_building = fort_16th 
	}
	else = {
		add_building = fort_15th 
	}
}

th_colonize_dev_province = {
	$province$ = {
		if = {
			limit = {
				is_empty = yes
			}
			cede_province = PREV
			add_core = PREV		
			change_religion = PREV
			change_culture = PREV
			add_base_tax = 1
			add_base_production = 1
			add_base_manpower = 1
		}
		else_if = {
			limit = {
				owner = {
					OR = { 
						tag = PREV
						is_subject_of = PREV
					}
				}
			}
			add_base_tax = 1
			add_base_production = 1
			add_base_manpower = 1
			if = {
				limit = {
					NOT = { religion = PREV }
				}
				change_religion = PREV
			}
			if = {
				limit = {
					NOT = { culture = PREV }
				}
				change_culture = PREV
			}
		}
		else = {
			add_permanent_claim = PREV
		}
	}
}

th_colonize_province_for_country = {	
	if = {
		limit = {
			is_empty = yes
		}
		cede_province = $who$
		add_core = $who$		
		change_religion = $who$
		change_culture = $who$
	}
	else_if = {
		limit = {
			owner = {
				OR = { 
					tag = $who$
					is_subject_of = $who$
				}
			}
		}
		add_base_tax = 1
		add_base_production = 1
		add_base_manpower = 1
		if = {
			limit = {
				NOT = { religion = $who$ }
			}
			change_religion = $who$
		}
		if = {
			limit = {
				NOT = { culture = $who$ }
			}
			change_culture = $who$
		}
	}
	else = {
		add_permanent_claim = $who$
	}
}

th_outdate_moon_defenses = {
	custom_tooltip = th_able_to_attack_lunarian_tt
	hidden_effect = {
		set_global_flag = th_lunarian_are_attackable_now_flag
	}
}

th_enable_conversion_dip_effect = {
	custom_tooltip = th_enable_conversion_dip_action
	hidden_effect = {
		set_global_flag = th_mry_conversion_enabled
	}
}

mry_enables_tributary_war_effect = {
	custom_tooltip = mry_enables_tributary_war_tt
	hidden_effect = {
		set_country_flag = th_enable_religious_tributary_war
	}
}

th_enables_conversion_privilege_effect = {
	custom_tooltip = th_enables_conversion_privilege
	hidden_effect = {
		set_country_flag = th_enabled_conversion_privilege_flag
	}
}

th_immunity_against_the_plague = {	
	custom_tooltip = emp_ven_plague_doctor_training_tt
	hidden_effect = {
		set_country_flag = has_competent_doctors
	}
}

th_increase_donations_from_events = {
	custom_tooltip = th_increase_donations_from_events_tt
	hidden_effect = {
		set_country_flag = th_increased_donations_from_events
	}
}

th_increase_youkai_hunt_money = {
	custom_tooltip = th_increased_youkai_hunt_income_tt
	hidden_effect = {
		set_country_flag = th_increased_youkai_hunt_income
	}
}

th_allow_shorter_deity_swapping = {
	custom_tooltip = th_allow_shorter_deity_swapping_tt
	hidden_effect = {
		set_country_flag = th_permanent_shorter_deity_swapping
	}
}

th_enable_burgling_action_effect = {
	custom_tooltip = th_enable_burgling_action_tt
	hidden_effect = {
		set_country_flag = th_enable_burgling_action
	}
}

th_enable_youkai_hunt_effect = {
	custom_tooltip = th_enable_youkai_hunt_tt
	hidden_effect = {
		set_country_flag = th_enable_youkai_hunt
		set_variable = {
			which = th_youkai_hunt_charges
			value = 5
		}
	}
}

th_enable_university_education = {
	custom_tooltip = th_enable_university_education_tt
	hidden_effect = {
		set_country_flag = th_university_education_enabled
		if = {
			limit = {
				has_country_flag = th_fairy_university_education_enabled
			}
			clr_country_flag = th_fairy_university_education_enabled
		}
	}
}

th_enable_fairy_university_education = {
	custom_tooltip = th_enable_university_education_tt
	hidden_effect = {
		set_country_flag = th_fairy_university_education_enabled
		if = {
			limit = {
				has_country_flag = th_university_education_enabled
			}
			clr_country_flag = th_university_education_enabled
		}
	}
}

th_enable_spring_power_effect = {
	custom_tooltip = th_enable_spring_power_effect_tt
	hidden_effect = {
		set_country_flag = th_power_of_spring_enabled
	}
}

th_increase_spring_power_effect = {
	if = {
		limit = {
			has_country_flag = lil_extend_spring_lv2
		}
		custom_tooltip = th_increase_spring_power_effect_end
		tooltip = {
			add_country_modifier = {
				name = lil_spring_buff_lv4
				duration = -1
			}
		}
		hidden_effect = {
			set_country_flag = lil_extend_spring_lv3
		}
	}
	else_if = {
		limit = {
			has_country_flag = lil_extend_spring_lv1
		}
		custom_tooltip = th_increase_spring_power_effect_boundless
		tooltip = {
			add_country_modifier = {
				name = lil_spring_buff_lv3
				duration = 270
			}
		}
		hidden_effect = {
			set_country_flag = lil_extend_spring_lv2
		}
	}
	else = {
		custom_tooltip = th_increase_spring_power_effect_boundless
		tooltip = {
			add_country_modifier = {
				name = lil_spring_buff_lv2
				duration = 180
			}
		}
		hidden_effect = {
			set_country_flag = lil_extend_spring_lv1
		}
	}
}

th_increase_berserk_spreading_effect = {
	custom_tooltip = th_increase_berserk_spreading_tt
	hidden_effect = {
		set_country_flag = th_increase_berserk_spreading
	}
}

th_enable_colonial_maintenance_reduction_effect = {
	custom_tooltip = th_enable_colonial_maintenance_reduction_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { has_country_flag = th_enable_colonial_maitenance_reduction }
			}
			set_country_flag = th_enable_colonial_maitenance_reduction
			set_variable = {
				which = th_allowed_colonies_for_reduction
				value = 1
			}
		}
		else = {
			change_variable = {
				which = th_allowed_colonies_for_reduction
				value = 1
			}
		}
	}
}

th_remove_autonomy_from_all_provinces_effect = {
	custom_tooltip = th_remove_autonomy_from_all_provinces
	hidden_effect = {
		every_owned_province = {
			add_local_autonomy = -100
		}
	}
}

th_add_manufactory = {
	if = {
		limit = {
			trade_goods = coal
			has_dlc = "Rule Britannia"
		}
		add_building = furnace
	}
	if = {
		limit = {
			OR = {
				trade_goods = salt
				trade_goods = fish
				trade_goods = naval_supplies
				trade_goods = seafood
				trade_goods = tar
			}
		}
		add_building = wharf
	}
	if = {
		limit = {
			OR = {
				trade_goods = copper
				trade_goods = iron
				trade_goods = lead
				trade_goods = mercury
				trade_goods = tin
				trade_goods = bronze
				trade_goods = metalworking
				trade_goods = munitions
				trade_goods = zinc
				trade_goods = cannon
				trade_goods = brass
			}
		}
		add_building = weapons
	}
	if = {
		limit = { 
			OR = {
				trade_goods = wool
				trade_goods = cloth
				trade_goods = silk
				trade_goods = dyes
			}
		}
		add_building = textile
	}
	if = {
		limit = {
			OR = {
				trade_goods = coffee
				trade_goods = cotton
				trade_goods = sugar
				trade_goods = tobacco
				trade_goods = tea
				trade_goods = cocoa
				trade_goods = palm_oil
				trade_goods = saffron
				trade_goods = cinnamon
				trade_goods = clove
				trade_goods = opium
				trade_goods = dates
				trade_goods = vanilla
			}
		}
		add_building = plantations
	}
	if = {
		limit = {
			OR = {
				trade_goods = ivory
				trade_goods = slaves
				trade_goods = spices
				trade_goods = fur
				trade_goods = incense
				trade_goods = whaling
				trade_goods = beer
				trade_goods = rum
				trade_goods = jade
				trade_goods = marble
				trade_goods = gunpowder
				trade_goods = cheese
				trade_goods = carpet
				trade_goods = exotic_animals
				trade_goods = sulfur
				trade_goods = leather
				trade_goods = woodworking
				trade_goods = jewellery
				trade_goods = maple_syrup
			}
		}
		add_building = tradecompany
	}
	if = {
		limit = {
			OR = {
				trade_goods = grain
				trade_goods = livestock
				trade_goods = wine
				trade_goods = sake
				trade_goods = apiculture
				trade_goods = rice
				trade_goods = horses
				trade_goods = olive_oil
				trade_goods = camel
				trade_goods = elephants
				trade_goods = citrus
				trade_goods = potato
				trade_goods = maize
				trade_goods = tomato
			}
		}
		add_building = farm_estate
	}
	if = {
		limit = {
			OR = {
				trade_goods = paper
				trade_goods = gems
				trade_goods = tropical_wood
				trade_goods = glass
				trade_goods = chinaware
				trade_goods = lumber
				trade_goods = ebony
				trade_goods = amber
				trade_goods = steam_engine
				trade_goods = optics
			}
		}
		add_building = mills
	}
}

th_get_default_permanent_province_buff = {
	hidden_effect = {
		home_trade_node_effect_scope = {
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
				}
				save_event_target_as = reward_province
			}
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
					is_capital = yes
				}
				save_event_target_as = reward_province
			}
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
					development = CAPITAL
					is_capital = no
				}
				save_event_target_as = reward_province
			}
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
					development = CAPITAL
					is_capital = no
					development = 20
				}
				save_event_target_as = reward_province
			}
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
					development = CAPITAL
					is_capital = no
					development = 25
				}
				save_event_target_as = reward_province
			}
			random_trade_node_member_province = {
				limit = {
					owned_by = ROOT
					development = CAPITAL
					is_capital = no
					development = 30
				}
				save_event_target_as = reward_province
			}
		}
	}
	if = {
		limit = { has_saved_event_target = reward_province }
		event_target:reward_province = {
			add_province_modifier = {
				name = "dominant_trade_hub"
				duration = -1
			}
		}
	}
	else = {
		custom_tooltip = dominant_home_node_reward_tooltip
	}
}


###CIN specific reward###
cin_tolerate_or_purge_culture = {
	if = {
		limit = {
			has_country_flag = cin_tolerant_path_mission
		}
		if = {
			limit = {
				NOT = { accepted_culture = $culture$ }
			}
			add_accepted_culture = $culture$
		}
		custom_tooltip = CIN_tolerant_effect_tt
		tooltip = {
			add_country_modifier = {
				name = $tolerance_modifier$
				duration = $tolerance_duration$
			}
		}
		hidden_effect = {
			every_province = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
					culture = $culture$
					NOT = { culture = ROOT }
				}
				add_province_modifier = {
					name = $tolerance_modifier$
					duration = $tolerance_duration$
				}
			}
		}
	}
	else_if = {
		limit = {
			has_country_flag = cin_vengeance_path_mission
		}
		custom_tooltip = CIN_vengeance_effect_tt
		tooltip = {
			random_province = {
				limit = {
					culture = $culture$
					NOT = { culture = ROOT }
				}
				add_province_modifier = {
					name = $vengeance_modifier$
					duration = $vengeance_duration$
				}
			}
		}
		hidden_effect = {
			every_province = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
					culture = $culture$
					NOT = { culture = ROOT }
				}
				add_province_modifier = {
					name = $vengeance_modifier$
					duration = $vengeance_duration$
				}
			}
		}
	}
	else = {		
		custom_tooltip = CIN_path_depended_reward
	}
}

###LAR specific reward###
lar_improve_eternitys_god_level = {
	if = {
		limit = {
			NOT = { has_country_flag = lar_rised_to_godhood }
		}
		hidden_effect = {
			set_country_flag = lar_rised_to_godhood
		}
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv1
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_country_modifier = lar_acknowledgement_as_goddess_lv1
		}
		remove_country_modifier = lar_acknowledgement_as_goddess_lv1
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv2
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_country_modifier = lar_acknowledgement_as_goddess_lv2
		}
		remove_country_modifier = lar_acknowledgement_as_goddess_lv2
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv3
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_country_modifier = lar_acknowledgement_as_goddess_lv3
		}
		remove_country_modifier = lar_acknowledgement_as_goddess_lv3
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv4
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_country_modifier = lar_acknowledgement_as_goddess_lv4
		}
		remove_country_modifier = lar_acknowledgement_as_goddess_lv4
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv5
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_country_modifier = lar_acknowledgement_as_goddess_lv5
		}
		remove_country_modifier = lar_acknowledgement_as_goddess_lv5
		add_country_modifier = {
			name = lar_acknowledgement_as_goddess_lv6
			duration = -1
		}
	}
}

###SFF specific reward###
sff_enable_drain_nature_action = {
	custom_tooltip = sff_enable_drain_nature_action_tt
	hidden_effect = {
		set_country_flag = sff_enabled_drain_nature
	}
}