#This file contains the effects necessary for a scaling uproar if Satori has too many subjects

#Update slot tracker for overlord
th_satori_vassal_update_slot_tracker = {
	#Update the Slot Tracker
	export_to_variable = {
		which = th_diplo_slot_tracker
		value = modifier:vassal_upkeep
		who = ROOT
	}
	if = {
		limit = {
			NOT = { num_of_subjects = 1 }
		}
		set_variable = {
			which = th_subject_tracker
			value = 0
		}
	}
	else = {
		set_variable = {
			which = th_subject_counter
			value = 0
		}
		every_subject_country = {
			limit = {
				is_subject_of_type = th_satori_vassal
			}
			overlord = {
				change_variable = {
					which = th_subject_counter
					value = 1
				}
			}
		}
		set_variable = {
			which = th_subject_tracker
			which = th_subject_counter
		}
	}
	set_variable = {
		which = th_subjects_over_limit
		which = th_subject_tracker
	}
	subtract_variable = {
		which = th_subjects_over_limit
		which = th_diplo_slot_tracker
	}
}

#Add scaling liberty desire to subject
#Root is in that case the overlord
th_satori_vassal_add_liberty_desire = {
	if = {	#Subjects become independent!
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 9
				}
			}
		}
		custom_tooltip = th_satori_vassal_add_liberty_desire_independence_tt
		hidden_effect = {
			ROOT = {
				country_event = {
					id = th_satori_vassal_mechanic.12
				}
			}
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 8
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_8
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 7
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_7
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 6
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_6
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 5
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_5
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 4
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_4
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 3
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_3
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 2
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_2
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_1
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else_if = {
		limit = {
			ROOT = {
				check_variable = {
					which = th_subjects_over_limit
					value = 1
				}
			}
		}
		add_country_modifier = {
			name = th_desire_for_freedom_1
			duration = -1
		}
		hidden_effect = {
			remove_country_modifier = th_desire_for_freedom_2
			remove_country_modifier = th_desire_for_freedom_3
			remove_country_modifier = th_desire_for_freedom_4
			remove_country_modifier = th_desire_for_freedom_5
			remove_country_modifier = th_desire_for_freedom_6
			remove_country_modifier = th_desire_for_freedom_7
			remove_country_modifier = th_desire_for_freedom_8
		}
	}
	else = {
		th_satori_vassal_remove_all_liberty_desire = yes
	}
}

#Remove scaling liberty desire to subject
th_satori_vassal_remove_all_liberty_desire = {
	remove_country_modifier = th_desire_for_freedom_1
	remove_country_modifier = th_desire_for_freedom_2
	remove_country_modifier = th_desire_for_freedom_3
	remove_country_modifier = th_desire_for_freedom_4
	remove_country_modifier = th_desire_for_freedom_5
	remove_country_modifier = th_desire_for_freedom_6
	remove_country_modifier = th_desire_for_freedom_7
	remove_country_modifier = th_desire_for_freedom_8
}

th_satori_clean_up_all_modifiers = {
	th_satori_vassal_remove_all_liberty_desire = yes
	remove_country_modifier = th_admin_support
	remove_country_modifier = th_satoris_command
	remove_country_modifier = th_false_memory_cd
	remove_country_modifier = th_influencing_vassal
	remove_country_modifier = th_hellish_officers
}