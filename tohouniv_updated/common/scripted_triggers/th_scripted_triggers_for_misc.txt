###DIVINE STATE###

th_ds_has_enhanced_deity_active = {
	OR = {
		AND = {	#Hakurei
			has_country_flag = th_ds_improved_deity_for_hakurei
			has_personal_deity = Hakurei_God 
		}
		AND = {	#Yakumo
			has_country_flag = th_ds_improved_deity_for_yakumo
			has_personal_deity = Yukari 
		}
		AND = {	#Hecatia
			has_country_flag = th_ds_improved_deity_for_hecatia
			has_personal_deity = Hecatia
		}
		AND = {	#Okina
			has_country_flag = th_ds_improved_deity_for_okina
			has_personal_deity = Okina 
		}
		AND = {	#Aki
			has_country_flag = th_ds_improved_deity_for_aki
			has_personal_deity = Aki_Sisters 
		}
		AND = {	#Junko
			has_country_flag = th_ds_improved_deity_for_junko
			has_personal_deity = Junko 
		}
		AND = {	#Kishin
			has_country_flag = th_ds_improved_deity_for_kishin
			has_personal_deity = Kishin
		}
		AND = {	#Shinki
			has_country_flag = th_ds_improved_deity_for_shinki
			has_personal_deity = Shinki
		}
		AND = {	#Keiki
			has_country_flag = th_ds_improved_deity_for_keiki
			has_personal_deity = Keiki
		}
		AND = {	#Hina
			has_country_flag = th_ds_improved_deity_for_hina
			has_personal_deity = Hina
		}
		AND = {	#Kochiya
			has_country_flag = th_ds_improved_deity_for_kochiya
			has_personal_deity = Kochiya
		}
		AND = {	#Moriya
			has_country_flag = th_ds_improved_deity_for_moriya
			has_personal_deity = Moriya 
		}
		AND = {	#Kanako
			has_country_flag = th_ds_improved_deity_for_kanako
			has_personal_deity = Kanako
		}
	}
}

###DEITIES###

th_hkr_deity_at_war_with_hakurei = {
	NOT = { tag = HKR }
	NOT = { was_tag = HKR }
	offensive_war_with = HKR
	has_personal_deity = Hakurei_God
}

th_hkr_deity_at_war_with_yukari = {
	NOT = { tag = MHG }
	NOT = { was_tag = MHG }
	offensive_war_with = MHG
	has_personal_deity = Yukari
}

th_hkr_deity_at_war_with_hecatia = {
	NOT = { tag = HEC }
	NOT = { was_tag = HEC }
	offensive_war_with = HEC
	has_personal_deity = Hecatia
}

th_hkr_deity_at_war_with_okina = {
	NOT = { tag = OKI }
	NOT = { was_tag = OKI }
	offensive_war_with = OKI
	has_personal_deity = Okina
}

th_hkr_deity_at_war_with_aki = {
	NOT = { tag = AKI }
	NOT = { was_tag = AKI }
	offensive_war_with = AKI
	has_personal_deity = Aki_Sisters
}

th_hkr_deity_at_war_with_junko = {
	NOT = { tag = JNK }
	NOT = { was_tag = JNK }
	offensive_war_with = JNK
	has_personal_deity = Junko
}

th_hkr_deity_at_war_with_kishin = {
	NOT = { tag = LCU }
	NOT = { was_tag = LCU }
	offensive_war_with = LCU
	has_personal_deity = Kishin
}

th_hkr_deity_at_war_with_shinki = {
	NOT = { tag = MKI }
	NOT = { was_tag = MKI }
	offensive_war_with = MKI
	has_personal_deity = Shinki
}

th_hkr_deity_at_war_with_keiki = {
	NOT = { tag = KEI }
	NOT = { was_tag = KEI }
	offensive_war_with = KEI
	has_personal_deity = Keiki
}

th_hkr_deity_at_war_with_hina = {
	NOT = { tag = YOF }
	NOT = { was_tag = YOF }
	offensive_war_with = YOF
	has_personal_deity = Hina
}

th_hkr_deity_is_at_war_with_deitys_home = {
	is_at_war = yes
	religion = th_hakureishinto
	OR = {
		th_hkr_deity_at_war_with_hakurei = yes
		th_hkr_deity_at_war_with_yukari = yes
		th_hkr_deity_at_war_with_hecatia = yes
		th_hkr_deity_at_war_with_okina = yes
		th_hkr_deity_at_war_with_aki = yes
		th_hkr_deity_at_war_with_junko = yes
		th_hkr_deity_at_war_with_kishin = yes
		th_hkr_deity_at_war_with_shinki = yes
		th_hkr_deity_at_war_with_keiki = yes
		th_hkr_deity_at_war_with_hina = yes
		th_hkr_deity_at_war_with_larva = yes
	}
}

###MRY SHINTO TRIGGERS###

th_mry_shinto_has_sanae_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_hakureis_power
		has_country_modifier = th_mry_shinto_keikis_idols
		has_country_modifier = th_mry_shinto_kishin_lunar_naval
	}
}

th_mry_shinto_has_suwako_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_sukunas_envoys
		has_country_modifier = th_mry_shinto_hinas_misfortune
		has_country_modifier = th_mry_shinto_hecatias_hell_workers
	}
}

th_mry_shinto_has_kanako_buffs = {
	OR = {
		has_country_modifier = th_mry_shinto_junkos_fury
		has_country_modifier = th_mry_shinto_shinkis_merchants
		has_country_modifier = th_mry_shinto_satoris_influence
	}
}

###EIT VARIABLE###

th_eit_has_max_aggressors = {
	check_variable = {
		which = th_eit_aggressor_counter
		value = 5
	}
}

th_eit_has_at_least_one_aggressor = {
	check_variable = {
		which = th_eit_aggressor_counter
		value = 1
	}
}

###FUJ VARIABLE###

th_fuj_has_n_volcanos = {
	check_variable = {
		which = th_fuj_volcano_counter
		value = $value$
	}
}

###PLEDGED TO RELIGION###
th_religious_pledged = {
	custom_trigger_tooltip = {
		tooltip = th_pledged_to_religion_tt
		OR = {
			has_country_flag = th_pledged_to_religion_to_@$tag$
			AND = {
				is_subject_of = $tag$
				has_country_modifier = th_subjugated_in_penance
			}
		}
	}
}

###MASKED ILLUSION IS RULER###
th_ruler_is_a_masked_illusion = {
	custom_trigger_tooltip = {
		tooltip = th_ruler_is_a_masked_illusion_tt
		has_ruler_flag = th_a_feminist_major
	}
}

th_ruler_is_not_a_masked_illusion = {
	custom_trigger_tooltip = {
		tooltip = th_ruler_is_not_a_masked_illusion_tt
		NOT = { has_ruler_flag = th_a_feminist_major }
	}
}

###ROOT HAS WON A DANMAKU DUEL AGAINST THE SCOPE###
th_has_lost_danmaku_duel_against_scope = {
	custom_trigger_tooltip = {
		tooltip = th_has_lost_danmaku_duel_against_scope_tt
		has_country_flag = th_danmaku_duel_lost_against_@ROOT
	}
}


###IS OR WAS TAG###
th_is_or_was_tag = {
	OR = {
		tag = $tag$
		was_tag = $tag$
	}
}

###GENSOKYO OR MOON CONTINENT###
th_gensokyo_or_moon_continent = {
	OR = {
		continent = gensokyo_continent
		continent = moon_continent
	}
}

###TOUHOU CULTURE GROUP###
th_is_touhou_culture_group = {
	OR = {
		culture_group = Gensokyan_culture
	}
}

###HAS TOUHOU TECHNOLOGY###
th_has_touhou_technology = {
	OR = {
		technology_group = tech_gensokyan
		technology_group = tech_lunarian
		technology_group = tech_gensokyan_lunarian
	}
}

###HAS NOT ORIGINAL TOUHOU RULER###
th_has_not_original_ruler = {
	custom_trigger_tooltip = {
		tooltip = th_has_not_original_ruler_tt
		NOT = { has_ruler_flag = touhou_original_ruler }
	}
}

###HAS NOT ORIGINAL TOUHOU HEIR###
th_has_not_original_heir = {
	custom_trigger_tooltip = {
		tooltip = th_has_not_original_heir_tt
		NOT = { has_heir_flag = touhou_original_heir }
	}
}

###TOUHOU HEIR IS NOT CURRENT RULER###
th_has_not_original_heir_as_ruler = {
	custom_trigger_tooltip = {
		tooltip = th_has_not_original_heir_as_ruler_tt
		NOT = { has_ruler_flag = touhou_original_heir }
	}
}

###TAG LISTS WITH IMMORTAL RULERS###
th_is_or_was_a_tag_with_immortal_rulers = {
	OR = {		#even their capital is not in Gensokyo mainland, this decision is still valid
		th_is_or_was_tag = { tag = AKI }
		th_is_or_was_tag = { tag = CIN }
		th_is_or_was_tag = { tag = CLP }
		th_is_or_was_tag = { tag = CRD }
		th_is_or_was_tag = { tag = FLR }
		th_is_or_was_tag = { tag = GNU }
		th_is_or_was_tag = { tag = HEC }
		th_is_or_was_tag = { tag = HIG }
		th_is_or_was_tag = { tag = HNG }
		th_is_or_was_tag = { tag = HVR }
		th_is_or_was_tag = { tag = JNK }
		th_is_or_was_tag = { tag = KEI }
		th_is_or_was_tag = { tag = KKO }
		th_is_or_was_tag = { tag = KNN }
		th_is_or_was_tag = { tag = KOG }
		th_is_or_was_tag = { tag = KPP }
		th_is_or_was_tag = { tag = KSE }
		th_is_or_was_tag = { tag = LAR }
		th_is_or_was_tag = { tag = LCU }
		th_is_or_was_tag = { tag = LIL }
		th_is_or_was_tag = { tag = MIM }
		th_is_or_was_tag = { tag = MKI }
		th_is_or_was_tag = { tag = MKN }
		th_is_or_was_tag = { tag = MRY }
		th_is_or_was_tag = { tag = MYO }
		th_is_or_was_tag = { tag = NCS }
		th_is_or_was_tag = { tag = NET }
		th_is_or_was_tag = { tag = OKI }
		th_is_or_was_tag = { tag = ONI }
		th_is_or_was_tag = { tag = PRI }
		th_is_or_was_tag = { tag = RAI }
		th_is_or_was_tag = { tag = SCR }
		th_is_or_was_tag = { tag = SEK }
		th_is_or_was_tag = { tag = SFF }
		th_is_or_was_tag = { tag = SKI }
		th_is_or_was_tag = { tag = SKT }
		th_is_or_was_tag = { tag = SNK }
		th_is_or_was_tag = { tag = TFR }
		th_is_or_was_tag = { tag = TGU }
		th_is_or_was_tag = { tag = YAC }
		th_is_or_was_tag = { tag = YOF }
		th_is_or_was_tag = { tag = ORN }
		th_is_or_was_tag = { tag = OKU }
	}
}

th_is_or_was_a_tag_with_immortal_rulers_and_heir = {
	OR = {		#even their capital is not in Gensokyo mainland, this decision is still valid
		th_is_or_was_tag = { tag = AKI }
		th_is_or_was_tag = { tag = CRD }
		th_is_or_was_tag = { tag = GNU }
		th_is_or_was_tag = { tag = LCU }
		th_is_or_was_tag = { tag = PRI }
		th_is_or_was_tag = { tag = TFR }
		#th_is_or_was_tag = { tag = SCR }	#SCR is special exception due to Flandre being able to leave SCR
		th_is_or_was_tag = { tag = MKN }
	}
}

#This trigger is only used as a memo to keep in mind which nations are special
th_exception_tags = {
	tag = FOM	#Alice is immortal and Marisa will respawn after mission
	tag = HKR	#Suika is immortal and Reimu will respawn after mission
	tag = SCR	#Flandre can permanently leave Scarlet Realm
	tag = MHG	#Already has a respawn decision
	tag = FUJ	#^
	tag = EIT	#^
	
	tag = SCD	#Can be either Scarlets or Komeiji
	tag = NMG	#Can be either Yakumo or Saigyouji
	tag = FTP	#Is a fairy republic anyway
	tag = GNK	#This could be ANYONE
}

#Fairies have their own respawn mechanic
th_is_a_tag_with_fairy_rulers = {
	th_is_or_was_tag = { tag = CIN }	#Cirno
	th_is_or_was_tag = { tag = CLP }	#Clownpiece
	th_is_or_was_tag = { tag = LAR }	#Larva
	th_is_or_was_tag = { tag = LIL }	#Lily
	th_is_or_was_tag = { tag = TFR }	#Sunny, Star and Luna
}


th_is_a_tag_with_immortal_rulers = {
	OR = {		#even their capital is not in Gensokyo mainland, this decision is still valid
		tag = AKI
		tag = CIN
		tag = CLP
		tag = CRD
		tag = EIT
		tag = FLR
		tag = FOM
		tag = FUJ
		tag = GNU
		tag = HEC
		tag = HIG
		tag = HNG
		tag = HVR
		tag = JNK
		tag = KEI
		tag = KKO
		tag = KNN
		tag = KOG
		tag = KPP
		tag = KSE
		tag = LAR
		tag = LCU
		tag = LIL
		tag = MHG
		tag = MIM
		tag = MKI
		tag = MRY
		tag = MYO
		tag = NCS
		tag = NET
		tag = OKI
		tag = ONI
		tag = PRI
		tag = RAI
		tag = SCR
		tag = SEK
		tag = SFF
		tag = SKI
		tag = SKT
		tag = SNK
		tag = TFR
		tag = TGU
		tag = YAC
		tag = YOF
		tag = NMG
		tag = SCD
		tag = FTP
		tag = GNK
		tag = MKN
		tag = ORN
		tag = OKU
	}
}


#Fairies respawn costs

th_fairy_respawn_has_monarch_power = {
	custom_trigger_tooltip = {
		tooltip = th_fairy_respawn_has_$type$_power_for_$character$_tt
		OR = {
			AND = {
				check_variable = {
					which = $variable$
					value = 6
				}
				$type$_power = 144
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 6
					}
				}
				check_variable = {
					which = $variable$
					value = 5
				}
				$type$_power = 120
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 5
					}
				}
				check_variable = {
					which = $variable$
					value = 4
				}
				$type$_power = 96
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 4
					}
				}
				check_variable = {
					which = $variable$
					value = 3
				}
				$type$_power = 72
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 3
					}
				}
				check_variable = {
					which = $variable$
					value = 2
				}
				$type$_power = 48
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 2
					}
				}
				check_variable = {
					which = $variable$
					value = 1
				}
				$type$_power = 24
			}
			AND = {
				NOT = {
					check_variable = {
						which = $variable$
						value = 1
					}
				}
				check_variable = {
					which = $variable$
					value = 0
				}
			}
		}
	}
}

###HAS ANY RELIGIOUS IDEAS ACTIVE###

th_has_religious_ideas = {
	custom_trigger_tooltip = {
		tooltip = th_has_religious_ideas_tt
		OR = {
			has_idea_group = religious_ideas
			has_idea_group = christian_idea_groups_expanded
			has_idea_group = muslim_idea_groups_expanded
			has_idea_group = confucian_idea_groups_expanded
			has_idea_group = th_gensokyan_ideas
			has_idea_group = th_moriya_ideas
			#Taoism
			#Buddhism
			#Lunarian
			#Touhou Christians
			#Old Hakurei
			#Shinkism
		}
	}
}

th_has_full_religious_ideas = {
	custom_trigger_tooltip = {
		tooltip = th_has_full_religious_ideas_tt
		OR = {
			full_idea_group = religious_ideas
			full_idea_group = christian_idea_groups_expanded
			full_idea_group = muslim_idea_groups_expanded
			full_idea_group = confucian_idea_groups_expanded
			full_idea_group = th_gensokyan_ideas
			full_idea_group = th_moriya_ideas
			#Taoism
			#Buddhism
			#Lunarian
			#Touhou Christians
			#Old Hakurei
			#Shinkism
		}
	}
}

th_religious_ideas_trigger = {
	#When used please make a custom tooltip for it in the function you use
	#Because nobody at Paradox could *possibly* imagine that 
	#somebody would like to parse the parameters to the localizations
	OR = {
		religious_ideas = $ideas$
		christian_idea_groups_expanded = $ideas$
		muslim_idea_groups_expanded = $ideas$
		confucian_idea_groups_expanded = $ideas$
		th_gensokyan_ideas = $ideas$
		th_moriya_ideas = $ideas$
		#Taoism
		#Buddhism
		#Lunarian
		#Touhou Christians
		#Old Hakurei
		#Shinkism
	}
}

###HELLFAIRY MECHANIC###
hellfairy_has_no_stack = {
	NOT = { has_province_modifier = th_hellfairy_berserk_1 }
	NOT = { has_province_modifier = th_hellfairy_berserk_2 }
	NOT = { has_province_modifier = th_hellfairy_berserk_3 }
	NOT = { has_province_modifier = th_hellfairy_berserk_4 }
	NOT = { has_province_modifier = th_hellfairy_berserk_5 }
	NOT = { has_province_modifier = th_hellfairy_berserk_6 }
	NOT = { has_province_modifier = th_hellfairy_berserk_7 }
	NOT = { has_province_modifier = th_hellfairy_berserk_8 }
	NOT = { has_province_modifier = th_hellfairy_berserk_9 }
	NOT = { has_province_modifier = th_hellfairy_berserk_10 }
}

hellfairy_had_stack_for_duration = {
	OR = {
		had_province_flag = { flag = th_hellfairy_province_has_stack_1 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_2 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_3 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_4 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_5 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_6 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_7 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_8 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_9 days = $days$ }
		had_province_flag = { flag = th_hellfairy_province_has_stack_10 days = $days$ }
	}
}

hellfairy_has_not_reached_maximum = {
	NOT = { has_province_modifier = th_hellfairy_berserk_10 }
}

hellfairy_has_any_flag = {
	OR = {
		has_province_flag = th_hellfairy_province_has_positive_berserk
		has_province_flag = th_hellfairy_province_has_conquest_debuff
		has_province_flag = th_hellfairy_province_has_stack_1
		has_province_flag = th_hellfairy_province_has_stack_2
		has_province_flag = th_hellfairy_province_has_stack_3
		has_province_flag = th_hellfairy_province_has_stack_4
		has_province_flag = th_hellfairy_province_has_stack_5
		has_province_flag = th_hellfairy_province_has_stack_6
		has_province_flag = th_hellfairy_province_has_stack_7
		has_province_flag = th_hellfairy_province_has_stack_8
		has_province_flag = th_hellfairy_province_has_stack_9
		has_province_flag = th_hellfairy_province_has_stack_1
	}
}